<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kosta.ems.student.StudentMapper">
    <select id="selectStudentByName" parameterType="string" resultType="com.kosta.ems.student.StudentCourseInfoDTO">
        select s.student_id         as studentId,
               hrd_net_id           as hrdNetID,
               name,
               birth,
               address,
               bank,
               account,
               phone_number         as phoneNumber,
               email,
               gender,
               manager_id           as managerId,
               is_active            as isActive,
               c.student_course_seq as studentCourseSeq,
               c.course_seq         as courseSeq
        from students s
                 left join students_courses c on s.student_id = c.student_id
        where s.name = '%' + #{name} + '%'
          and is_active = 'T'
    </select>
	<select id="findByStudentNameOrCourseNumber" resultType="com.kosta.ems.student.StudentBasicInfoDTO">
		SELECT s.student_id AS studentId, s.hrd_net_id AS hrdNetId, c.course_number AS courseNumber, s.name , s.birth,
	s.address, s.bank, s.account, s.phone_number AS phoneNumber, s.email
FROM students s, courses c, students_courses sc
WHERE s.student_id=sc.student_id AND c.course_seq=sc.course_seq AND 
	(s.student_id IN (SELECT student_id FROM students WHERE name LIKE CONCAT('%', #{name}, '%'))
	OR c.course_seq=(SELECT course_seq FROM courses WHERE course_number=#{courseNumber}))
LIMIT #{start}, #{size}
	</select>
</mapper>
