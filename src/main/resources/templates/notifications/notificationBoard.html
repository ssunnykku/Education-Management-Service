<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <script src="https://code.jquery.com/jquery-3.7.1.slim.js"
            integrity="sha256-UgvvN8vBkgO0luPSUl2s8TIlOSYRoGFAX4jlCIm9Adc=" crossorigin="anonymous"></script>
    <title>Document</title>
    <link rel="stylesheet" href="../../css/notifications.css"/>
    <link rel="stylesheet" href="../../css/button.css"/>
    <link rel="stylesheet" href="../../css/format.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.1/font/bootstrap-icons.css">
</head>

<body id="notification-body">
<div th:insert="~{common/header :: header}"></div>
<div th:insert="~{common/title :: title ('공지사항')}"></div>
<section id="notification-section">
    <article class="notification-contents">
        <div id="notification-btn-wrapper">
          <div class="search-form-wrapper">
          <input placeholder="검색어를 입력하세요" id="search-input" class="search-input"/>
            <button type="button" class="board-filter-search-btn">검색</button> 
          </div>
            <button id="notification-enroll-btn" class="btn-setting">글 등록</button>
        </div>
        </article>
        <article>
        <div id="notification-table">
            <div class="notification-row" id="notification-title-row">
                <div class="notificationBoard-no">
                    <span>NO</span>
                </div>
                <div class="notificationBoard-title">
                    <span>제목</span>
                </div>
                <div class="notificationBoard-enroll-date">
                    <span>등록일</span>
                </div>
                <div class="notificationBoard-writer">
                    <span>작성자</span>
                </div>
                <div class="notification-view-count">
                <span>조회수</span>
            </div>
            </div>
    <div style="display: contents" id="notification-table-contents">
    </div>
  </div> 
  </article>
   <article class="scholarship-page-information">
        <ul id="pagination">
            <li>
                <a class="page-link" id="before">
                    이전
                </a>
            </li>
            <!--// 이게 페이지 번호-->
            <li class="page-item" id="page_number">
            </li>
            <li class="page-item">
                <a class="page-link" id="next">
                    다음
                </a>
            </li>
        </ul>
        </div>
    </article>
</section>

<footer></footer>
<script>


const params = new URL(location.href).search.split("=");
console.log(params);
let currentPage = 1;
const pageSize = 10; // 한 블록 당 페이지 수
let currentBlock = 1;

let totalPages = 0;

	$("#notification-enroll-btn").on("click", function(){
		location.href = "/ems/notifications/write";
	})
	
	document.querySelector(".board-filter-search-btn").onclick = function(){
	let keyword=document.querySelector('#search-input').value;
console.log(keyword);
		fetch("/notifications/list/"+keyword,{
			method: "get",
			headers: {
				"Content-Type": "application/json"
			}			
		})
		 .then(async (res) => {
      const response = await res.json();
      const notificationList = response.result;
      await getSettlementList(notificationList);   
    })
  }
	
async function getSettlementList(data) {
let result = '';
    for (let i = 0; i < data.length; i++) {
        result += `<div class="notification-row">
      <div class="notificationBoard-no" id="notificationBoard-no">
        <span>${data[i].notificationSeq}</span>
      </div>
      <div class="notificationBoard-title" id="notificationBoard-title">
    <a href="/ems/notification?notificationSeq=${data[i].notificationSeq}">${data[i].title}</a> 
      </div>
      <div class="notificationBoard-enroll-date">
        <span>${data[i].formattedNotificationDate}</span>
      </div>
      <div class="notificationBoard-writer">
        <span>${data[i].name}</span>
      </div>
      <div class="notification-view-count">
      <span>${data[i].viewCount}</span>
    </div>
    </div>`;
    }

 
     $("#notification-table-contents").html("");
    $("#notification-table-contents").append(result);
	}
$(document).ready(function() {
  fetch("/notifications")
    .then(async (res) => {
      const response = await res.json();
      const notificationList = response.result;
      await getSettlementList(notificationList);
    })
    .catch((error) => console.error(error));
});

</script>
</body>
